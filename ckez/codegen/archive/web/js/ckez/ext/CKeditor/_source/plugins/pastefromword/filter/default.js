(function(){var j=CKEDITOR.htmlParser.fragment.prototype,e=CKEDITOR.htmlParser.element.prototype;j.onlyChild=e.onlyChild=function(){var u=this.children,v=u.length,w=(v==1)&&u[0];return w||null};e.removeAnyChildWithName=function(w){var v=this.children,x=[],y;for(var u=0;u<v.length;u++){y=v[u];if(!y.name){continue}if(y.name==w){x.push(y);v.splice(u--,1)}x=x.concat(y.removeAnyChildWithName(w))}return x};e.getAncestor=function(u){var v=this.parent;while(v&&!(v.name&&v.name.match(u))){v=v.parent}return v};j.firstChild=e.firstChild=function(w){var v;for(var u=0;u<this.children.length;u++){v=this.children[u];if(w(v)){return v}else{if(v.name){v=v.firstChild(w);if(v){return v}}}}return null};e.addStyle=function(u,y,x){var z,v="";if(typeof y=="string"){v+=u+":"+y+";"}else{if(typeof u=="object"){for(var w in u){if(u.hasOwnProperty(w)){v+=w+":"+u[w]+";"}}}else{v+=u}x=y}if(!this.attributes){this.attributes={}}z=this.attributes.style||"";z=(x?[v,z]:[z,v]).join(";");this.attributes.style=z.replace(/^;|;(?=;)/,"")};CKEDITOR.dtd.parentOf=function(w){var v={};for(var u in this){if(u.indexOf("$")==-1&&this[u][w]){v[u]=1}}return v};function d(A){var v=A.children,u,C,z=A.children.length,y,B,D=/list-style-type:(.*?)(?:;|$)/,x=CKEDITOR.plugins.pastefromword.filters.stylesFilter;C=A.attributes;if(D.exec(C.style)){return}for(var w=0;w<z;w++){u=v[w];if(u.attributes.value&&Number(u.attributes.value)==w+1){delete u.attributes.value}y=D.exec(u.attributes.style);if(y){if(y[1]==B||!B){B=y[1]}else{B=null;break}}}if(B){for(w=0;w<z;w++){C=v[w].attributes;C.style&&(C.style=x([["list-style-type"]])(C.style)||"")}A.addStyle("list-style-type",B)}}var p=/^([.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i;var s=/^(?:\b0[^\s]*\s*){1,4}$/;var i="^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$",k=new RegExp(i),a=new RegExp(i.toUpperCase());var m={decimal:/\d+/,"lower-roman":k,"upper-roman":a,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},l={disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/},t={ol:m,ul:l},f=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],g="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function q(z){z=z.toUpperCase();var u=f.length,y=0;for(var x=0;x<u;++x){for(var w=f[x],v=w[1].length;z.substr(0,v)==w[1];z=z.substr(v)){y+=w[0]}}return y}function n(y){y=y.toUpperCase();var v=g.length,w=1;for(var u=1;y.length>0;u*=v){w+=g.indexOf(y.charAt(y.length-1))*u;y=y.substr(0,y.length-1)}return w}var o=0,h=null,c;var b=(CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(v,w){var u=new CKEDITOR.htmlParser.element("cke:listbullet");u.attributes={"cke:listsymbol":v[0]};u.add(new CKEDITOR.htmlParser.text(w));return u},isListBulletIndicator:function(u){var v=u.attributes&&u.attributes.style;if(/mso-list\s*:\s*Ignore/i.test(v)){return true}},isContainingOnlySpaces:function(u){var v;return((v=u.onlyChild())&&(/^(:?\s|&nbsp;)+$/).test(v.value))},resolveList:function(w){var u=w.attributes,v;if((v=w.removeAnyChildWithName("cke:listbullet"))&&v.length&&(v=v[0])){w.name="cke:li";if(u.style){u.style=b.filters.stylesFilter([["text-indent"],["line-height"],[(/^margin(:?-left)?$/),null,function(y){var x=y.split(" ");y=b.utils.convertToPx(x[3]||x[1]||x[0]);y=parseInt(y,10);if(!o&&h!==null&&y>h){o=y-h}h=y;u["cke:indent"]=o&&(Math.ceil(y/o)+1)||1}],[(/^mso-list$/),null,function(z){z=z.split(" ");var y=Number(z[0].match(/\d+/)),x=Number(z[1].match(/\d+/));y!==c&&(u["cke:reset"]=1);c=y;u["cke:indent"]=x}]])(u.style,w)||""}if(!u["cke:indent"]){h=0;u["cke:indent"]=1}CKEDITOR.tools.extend(u,v.attributes);return true}else{c=h=o=null}return false},convertToPx:(function(){var u=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(u);return function(v){if(p.test(v)){u.setStyle("width",v);return u.$.clientWidth+"px"}return v}})(),getStyleComponents:(function(){var u=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"></div>',CKEDITOR.document);CKEDITOR.document.getBody().append(u);return function(x,v,w){u.setStyle(x,v);var A={},z=w.length;for(var y=0;y<z;y++){A[w[y]]=u.getStyle(w[y])}return A}})(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(y){var F=y.attributes,C=y.parent;var z,E=1;while(C){C.attributes&&C.attributes["cke:list"]&&E++;C=C.parent}switch(F.type){case"a":z="lower-alpha";break}var w=y.children,v;for(var A=0;A<w.length;A++){v=w[A];var x=v.attributes;if(v.name in CKEDITOR.dtd.$listItem){var u=v.children,B=u.length,D=u[B-1];if(D.name in CKEDITOR.dtd.$list){w.splice(A+1,0,D);D.parent=y;if(!--u.length){w.splice(A,1)}}v.name="cke:li";F.start&&!A&&(x.value=F.start);b.filters.stylesFilter([["tab-stops",null,function(H){var G=H.split(" ")[1].match(p);G&&(h=parseInt(b.utils.convertToPx(G[0]),10))}],["mso-list",null,function(H){H=H.split(" ");var G=Number(H[0].match(/\d+/));G!==c&&(x["cke:reset"]=1);c=G}]])(x.style);x["cke:indent"]=E;x["cke:listtype"]=y.name;x["cke:list-style-type"]=z}}delete y.name;F["cke:list"]=1},assembleList:function(v){var z=v.children,A,D,E,y,G,w,M,P=[],N,L;var O,K,H,u;for(var I=0;I<z.length;I++){A=z[I];if("cke:li"==A.name){A.name="li";D=A;E=D.attributes;O=E["cke:listsymbol"];O=O&&O.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);K=H=u=null;if(E["cke:ignored"]){z.splice(I--,1);continue}E["cke:reset"]&&(M=G=w=null);y=Number(E["cke:indent"]);if(y!=G){L=N=null}if(!O){K=E["cke:listtype"]||"ol";H=E["cke:list-style-type"]}else{if(L&&t[L][N].test(O[1])){K=L;H=N}else{for(var x in t){for(var J in t[x]){if(t[x][J].test(O[1])){if(x=="ol"&&(/alpha|roman/).test(J)){var B=/roman/.test(J)?q(O[1]):n(O[1]);if(!u||B<u){u=B;K=x;H=J}}else{K=x;H=J;break}}}}}!K&&(K=O[2]?"ol":"ul")}L=K;N=H||(K=="ol"?"decimal":"disc");if(H&&H!=(K=="ol"?"decimal":"disc")){D.addStyle("list-style-type",H)}if(K=="ol"&&O){switch(H){case"decimal":u=Number(O[1]);break;case"lower-roman":case"upper-roman":u=q(O[1]);break;case"lower-alpha":case"upper-alpha":u=n(O[1]);break}D.attributes.value=u}if(!M){P.push(M=new CKEDITOR.htmlParser.element(K));M.add(D);z[I]=M}else{if(y>G){P.push(M=new CKEDITOR.htmlParser.element(K));M.add(D);w.add(M)}else{if(y<G){var F=G-y,C;while(F--&&(C=M.parent)){M=C.parent}M.add(D)}else{M.add(D)}}z.splice(I--,1)}w=D;G=y}else{if(M){M=G=w=null}}}for(I=0;I<P.length;I++){d(P[I])}M=G=w=c=h=o=null},falsyFilter:function(u){return false},stylesFilter:function(v,u){return function(z,x){var y=[];(z||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(D,C,G){C=C.toLowerCase();C=="font-family"&&(G=G.replace(/["']/g,""));var F,B,H,A;for(var E=0;E<v.length;E++){if(v[E]){F=v[E][0];B=v[E][1];H=v[E][2];A=v[E][3];if(C.match(F)&&(!B||G.match(B))){C=A||C;u&&(H=H||G);if(typeof H=="function"){H=H(G,x,C)}if(H&&H.push){C=H[0],H=H[1]}if(typeof H=="string"){y.push([C,H])}return}}}!u&&y.push([C,G])});for(var w=0;w<y.length;w++){y[w]=y[w].join(":")}return y.length?(y.join(";")+";"):false}},elementMigrateFilter:function(u,v){return function(w){var x=v?new CKEDITOR.style(u,v)._.definition:u;w.name=x.element;CKEDITOR.tools.extend(w.attributes,CKEDITOR.tools.clone(x.attributes));w.addStyle(CKEDITOR.style.getStyleText(x))}},styleMigrateFilter:function(v,w){var u=this.elementMigrateFilter;return function(z,y){var x=new CKEDITOR.htmlParser.element(null),A={};A[w]=z;u(v,A)(x);x.children=y.children;y.children=[x]}},bogusAttrFilter:function(v,u){if(u.name.indexOf("cke:")==-1){return false}},applyStyleFilter:null},getRules:function(x){var J=CKEDITOR.dtd,v=CKEDITOR.tools.extend({},J.$block,J.$listItem,J.$tableContent),N=x.config,F=this.filters,M=F.falsyFilter,A=F.stylesFilter,B=F.elementMigrateFilter,w=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),u=this.utils.createListBulletMarker,z=F.flattenList,H=F.assembleList,E=this.utils.isListBulletIndicator,C=this.utils.isContainingOnlySpaces,D=this.utils.resolveList,G=this.utils.convertToPx,K=this.utils.getStyleComponents,L=this.utils.listDtdParents,I=N.pasteFromWordRemoveFontStyles!==false,y=N.pasteFromWordRemoveStyles!==false;return{elementNames:[[(/meta|link|script/),""]],root:function(O){O.filterChildren();H(O)},elements:{"^":function(O){var P;if(CKEDITOR.env.gecko&&(P=F.applyStyleFilter)){P(O)}},$:function(R){var Q=R.name||"",P=R.attributes;if(Q in v&&P.style){P.style=A([[(/^(:?width|height)$/),null,G]])(P.style)||""}if(Q.match(/h\d/)){R.filterChildren();if(D(R)){return}B(N["format_"+Q])(R)}else{if(Q in J.$inline){R.filterChildren();if(C(R)){delete R.name}}else{if(Q.indexOf(":")!=-1&&Q.indexOf("cke")==-1){R.filterChildren();if(Q=="v:imagedata"){var O=R.attributes["o:href"];if(O){R.attributes.src=O}R.name="img";return}delete R.name}}}if(Q in L){R.filterChildren();H(R)}},style:function(P){if(CKEDITOR.env.gecko){var O=P.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/),Q=O&&O[1],R={};if(Q){Q.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(X,V,U){V=V.split(",");var W=V.length,S;for(var T=0;T<W;T++){CKEDITOR.tools.trim(V[T]).replace(/^(\w+)(\.[\w-]+)?$/g,function(Y,Z,aa){Z=Z||"*";aa=aa.substring(1,aa.length);if(aa.match(/MsoNormal/)){return}if(!R[Z]){R[Z]={}}if(aa){R[Z][aa]=U}else{R[Z]=U}})}});F.applyStyleFilter=function(T){var S=R["*"]?"*":T.name,V=T.attributes&&T.attributes["class"],U;if(S in R){U=R[S];if(typeof U=="object"){U=U[V]}U&&T.addStyle(U,true)}}}}return false},p:function(Q){if(/MsoListParagraph/.exec(Q.attributes["class"])){var R=Q.firstChild(function(S){return S.type==CKEDITOR.NODE_TEXT&&!C(S.parent)});var O=R&&R.parent,P=O&&O.attributes;P&&!P.style&&(P.style="mso-list: Ignore;")}Q.filterChildren();if(D(Q)){return}if(N.enterMode==CKEDITOR.ENTER_BR){delete Q.name;Q.add(new CKEDITOR.htmlParser.element("br"))}else{B(N["format_"+(N.enterMode==CKEDITOR.ENTER_P?"p":"div")])(Q)}},div:function(P){var Q=P.onlyChild();if(Q&&Q.name=="table"){var O=P.attributes;Q.attributes=CKEDITOR.tools.extend(Q.attributes,O);O.style&&Q.addStyle(O.style);var R=new CKEDITOR.htmlParser.element("div");R.addStyle("clear","both");P.add(R);delete P.name}},td:function(O){if(O.getAncestor("thead")){O.name="th"}},ol:z,ul:z,dl:z,font:function(P){if(E(P.parent)){delete P.name;return}P.filterChildren();var O=P.attributes,R=O.style,Q=P.parent;if("font"==Q.name){CKEDITOR.tools.extend(Q.attributes,P.attributes);R&&Q.addStyle(R);delete P.name}else{R=R||"";if(O.color){O.color!="#000000"&&(R+="color:"+O.color+";");delete O.color}if(O.face){R+="font-family:"+O.face+";";delete O.face}if(O.size){R+="font-size:"+(O.size>3?"large":(O.size<3?"small":"medium"))+";";delete O.size}P.name="span";P.addStyle(R)}},span:function(R){if(E(R.parent)){return false}R.filterChildren();if(C(R)){delete R.name;return null}if(E(R)){var Q=R.firstChild(function(Y){return Y.value||Y.name=="img"});var U=Q&&(Q.value||"l."),W=U&&U.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(W){var S=u(W,U);var T=R.getAncestor("span");if(T&&(/ mso-hide:\s*all|display:\s*none /).test(T.attributes.style)){S.attributes["cke:ignored"]=1}return S}}var P=R.children,X=R.attributes,O=X&&X.style,V=P&&P[0];if(O){X.style=A([["line-height"],[(/^font-family$/),null,!I?w(N.font_style,"family"):null],[(/^font-size$/),null,!I?w(N.fontSize_style,"size"):null],[(/^color$/),null,!I?w(N.colorButton_foreStyle,"color"):null],[(/^background-color$/),null,!I?w(N.colorButton_backStyle,"color"):null]])(O,R)||""}return null},b:B(N.coreStyles_bold),i:B(N.coreStyles_italic),u:B(N.coreStyles_underline),s:B(N.coreStyles_strike),sup:B(N.coreStyles_superscript),sub:B(N.coreStyles_subscript),a:function(P){var O=P.attributes;if(O&&!O.href&&O.name){delete P.name}},"cke:listbullet":function(O){if(O.getAncestor(/h\d/)&&!N.pasteFromWordNumberedHeadingToList){delete O.name}}},attributeNames:[[(/^onmouse(:?out|over)/),""],[(/^onload$/),""],[(/(?:v|o):\w+/),""],[(/^lang/),""]],attributes:{style:A(y?[[(/^list-style-type$/),null],[(/^margin$|^margin-(?!bottom|top)/),null,function(R,Q,P){if(Q.name in {p:1,div:1}){var O=N.contentsLangDirection=="ltr"?"margin-left":"margin-right";if(P=="margin"){R=K(P,R,[O])[O]}else{if(P!=O){return null}}if(R&&!s.test(R)){return[O,R]}}return null}],[(/^clear$/)],[(/^border.*|margin.*|vertical-align|float$/),null,function(P,O){if(O.name=="img"){return P}}],[(/^width|height$/),null,function(P,O){if(O.name in {table:1,td:1,th:1,img:1}){return P}}]]:[[(/^mso-/)],[(/-color$/),null,function(O){if(O=="transparent"){return false}if(CKEDITOR.env.gecko){return O.replace(/-moz-use-text-color/g,"transparent")}}],[(/^margin$/),s],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],I?[(/font-?/)]:null],y),width:function(P,O){if(O.name in J.$tableContent){return false}},border:function(P,O){if(O.name in J.$tableContent){return false}},"class":M,bgcolor:M,valign:y?M:function(P,O){O.addStyle("vertical-align",P);return false}},comment:!CKEDITOR.env.ie?function(U,O){var V=U.match(/<img.*?>/),P=U.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);if(P){var R=P[1]||(V&&"l."),T=R&&R.match(/>(?:[(]?)([^\s]+?)([.)]?)</);return u(T,R)}if(CKEDITOR.env.gecko&&V){var Q=CKEDITOR.htmlParser.fragment.fromHtml(V[0]).children[0],S=O.previous,W=S&&S.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/),X=W&&W[1];X&&(Q.attributes.src=X);return Q}return false}:M}}});var r=function(){this.dataFilter=new CKEDITOR.htmlParser.filter()};r.prototype={toHtml:function(w){var u=CKEDITOR.htmlParser.fragment.fromHtml(w,false),v=new CKEDITOR.htmlParser.basicWriter();u.writeHtml(v,this.dataFilter);return v.getHtml(true)}};CKEDITOR.cleanWord=function(x,v){if(CKEDITOR.env.gecko){x=x.replace(/(<!--\[if[^<]*?\])-->([\S\s]*?)<!--(\[endif\]-->)/gi,"$1$2$3")}var u=new r(),w=u.dataFilter;w.addRules(CKEDITOR.plugins.pastefromword.getRules(v));v.fire("beforeCleanWord",{filter:w});try{x=u.toHtml(x,false)}catch(y){alert(v.lang.pastefromword.error)}x=x.replace(/cke:.*?".*?"/g,"");x=x.replace(/style=""/g,"");x=x.replace(/<span>/g,"");return x}})();